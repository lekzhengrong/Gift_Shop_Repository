<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Select Gift Products</title>
    <style>
        .product-options { display: flex; gap: 20px; flex-wrap: wrap; }
        .product-option { text-align: center; width: 150px; }
        .product-option img { width: 150px; height: auto; }
    </style>
</head>
<body>
    <h2>Step 2: Choose Products</h2>
    <form action="/cart/add" method="POST" id="gift-products-form">
        <input type="hidden" name="id" value="{{ box_id }}">
        <div class="product-options">
            {% for product in collections['gift-products'].products %}
                <div class="product-option">
                    <input type="checkbox" id="product-{{ product.id }}" name="items[]" value="{{ product.id }}">
                    <label for="product-{{ product.id }}">
                        <img src="{{ product.featured_image | img_url: 'medium' }}" alt="{{ product.title }}">
                        <p>{{ product.title }}</p>
                    </label>
                </div>
            {% endfor %}
        </div>
        <button type="submit" class="add-to-cart-button">Add to Cart</button>
    </form>
    <script>
        // Add the selected gift box to the cart as part of the POST payload
        const urlParams = new URLSearchParams(window.location.search);
        const boxId = urlParams.get('box_id');
        document.querySelector('input[name="id"]').value = boxId;
    </script>
</body>
</html>
